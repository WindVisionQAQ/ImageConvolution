#include <stdio.h>
#include <stdlib.h>
	int b[1026][2050]={0};
	int g[1026][2050]={0};
	int r[1026][2050]={0};
	int d1[1024][2048]={0.0};
	int d2[1024][2048]={0.0};
	int d3[1024][2048]={0.0};
	int d4[1024][2048]={0.0};
	double f1[3][3]={1.0/9.0,1.0/9.0,1.0/9.0,1.0/9.0,1.0/9.0,1.0/9.0,1.0/9.0,1.0/9.0,1.0/9.0};
	double f2[3][3]={1.0/16.0,2.0/16.0,1.0/16.0,2.0/16.0,4.0/16.0,2.0/16.0,1.0/16.0,2.0/16.0,1.0/16.0};
	double f3[3][3]={-1.0,-1.0,-1.0,-1.0,9.0,-1.0,-1.0,-1.0,-1.0};
	double f4[3][3]={1.0,1.0,1.0,1.0,-8.0,1.0,1.0,1.0,1.0};

int main()
{
	FILE *fp;
	FILE *fp1;
	FILE *fp2;
	FILE *fp3;
	int i,j,k;
	int temp;
	double k1=1.0/3.0;
	double k2=1.0/3.0;
	double k3=1.0/3.0;
	fp=fopen("blue.txt","r");
	fp1=fopen("green.txt","r");
	fp2=fopen("red.txt","r");
	for(i=1;i<1025;i++)
	{
		for (j=1;j<2049;j++)
		{
			fscanf(fp,"%d",&b[i][j]);
			fscanf(fp1,"%d",&g[i][j]);
			fscanf(fp2,"%d",&r[i][j]);
		}
	}
	/*for(i=0;i<1024;i++)
		for(j=0;j<2048;j++)
			printf("%d ",b[i][j]);*/
	/*for(i=0;i<2050;i++)
		printf("%d ",b[1][i]);*/
	fclose(fp);
	fclose(fp1);
	fclose(fp2);
	for(i=0;i<1024;i++)
		for(j=0;j<2048;j++){
			d1[i][j]=k1*(f1[0][0]*r[i][j]+f1[0][1]*r[i][j+1]+f1[0][2]*r[i][j+2]+f1[1][0]*r[i+1][j]+f1[1][1]*r[i+1][j+1]+f1[1][2]*r[i+1][j+2]+f1[2][0]*r[i+2][j]+f1[2][1]*r[i+2][j+1]+f1[2][2]*r[i+2][j+2])+\
					 k2*(f1[0][0]*g[i][j]+f1[0][1]*g[i][j+1]+f1[0][2]*g[i][j+2]+f1[1][0]*g[i+1][j]+f1[1][1]*g[i+1][j+1]+f1[1][2]*g[i+1][j+2]+f1[2][0]*g[i+2][j]+f1[2][1]*g[i+2][j+1]+f1[2][2]*g[i+2][j+2])+\
					 k3*(f1[0][0]*b[i][j]+f1[0][1]*b[i][j+1]+f1[0][2]*b[i][j+2]+f1[1][0]*b[i+1][j]+f1[1][1]*b[i+1][j+1]+f1[1][2]*b[i+1][j+2]+f1[2][0]*b[i+2][j]+f1[2][1]*b[i+2][j+1]+f1[2][2]*b[i+2][j+2]);
			d2[i][j]=k1*(f2[0][0]*r[i][j]+f2[0][1]*r[i][j+1]+f2[0][2]*r[i][j+2]+f2[1][0]*r[i+1][j]+f2[1][1]*r[i+1][j+1]+f2[1][2]*r[i+1][j+2]+f2[2][0]*r[i+2][j]+f2[2][1]*r[i+2][j+1]+f2[2][2]*r[i+2][j+2])+\
					 k2*(f2[0][0]*g[i][j]+f2[0][1]*g[i][j+1]+f2[0][2]*g[i][j+2]+f2[1][0]*g[i+1][j]+f2[1][1]*g[i+1][j+1]+f2[1][2]*g[i+1][j+2]+f2[2][0]*g[i+2][j]+f2[2][1]*g[i+2][j+1]+f2[2][2]*g[i+2][j+2])+\
					 k3*(f2[0][0]*b[i][j]+f2[0][1]*b[i][j+1]+f2[0][2]*b[i][j+2]+f2[1][0]*b[i+1][j]+f2[1][1]*b[i+1][j+1]+f2[1][2]*b[i+1][j+2]+f2[2][0]*b[i+2][j]+f2[2][1]*b[i+2][j+1]+f2[2][2]*b[i+2][j+2]);
			d3[i][j]=k1*(f3[0][0]*r[i][j]+f3[0][1]*r[i][j+1]+f3[0][2]*r[i][j+2]+f3[1][0]*r[i+1][j]+f3[1][1]*r[i+1][j+1]+f3[1][2]*r[i+1][j+2]+f3[2][0]*r[i+2][j]+f3[2][1]*r[i+2][j+1]+f3[2][2]*r[i+2][j+2])+\
					 k2*(f3[0][0]*g[i][j]+f3[0][1]*g[i][j+1]+f3[0][2]*g[i][j+2]+f3[1][0]*g[i+1][j]+f3[1][1]*g[i+1][j+1]+f3[1][2]*g[i+1][j+2]+f3[2][0]*g[i+2][j]+f3[2][1]*g[i+2][j+1]+f3[2][2]*g[i+2][j+2])+\
					 k3*(f3[0][0]*b[i][j]+f3[0][1]*b[i][j+1]+f3[0][2]*b[i][j+2]+f3[1][0]*b[i+1][j]+f3[1][1]*b[i+1][j+1]+f3[1][2]*b[i+1][j+2]+f3[2][0]*b[i+2][j]+f3[2][1]*b[i+2][j+1]+f3[2][2]*b[i+2][j+2]);
			d4[i][j]=k1*(f4[0][0]*r[i][j]+f4[0][1]*r[i][j+1]+f4[0][2]*r[i][j+2]+f4[1][0]*r[i+1][j]+f4[1][1]*r[i+1][j+1]+f4[1][2]*r[i+1][j+2]+f4[2][0]*r[i+2][j]+f4[2][1]*r[i+2][j+1]+f4[2][2]*r[i+2][j+2])+\
					 k2*(f4[0][0]*g[i][j]+f4[0][1]*g[i][j+1]+f4[0][2]*g[i][j+2]+f4[1][0]*g[i+1][j]+f4[1][1]*g[i+1][j+1]+f4[1][2]*g[i+1][j+2]+f4[2][0]*g[i+2][j]+f4[2][1]*g[i+2][j+1]+f4[2][2]*g[i+2][j+2])+\
					 k3*(f4[0][0]*b[i][j]+f4[0][1]*b[i][j+1]+f4[0][2]*b[i][j+2]+f4[1][0]*b[i+1][j]+f4[1][1]*b[i+1][j+1]+f4[1][2]*b[i+1][j+2]+f4[2][0]*b[i+2][j]+f4[2][1]*b[i+2][j+1]+f4[2][2]*b[i+2][j+2]);
		}
	fp=fopen("d1.txt","w");
	fp1=fopen("d2.txt","w");
	fp2=fopen("d3.txt","w");
	fp3=fopen("d4.txt","w");
	for (i=0;i<1024;i++){
		for (j=0;j<2048;j++){
			if(j!=2047) {
				fprintf(fp,"%d ",(int)d1[i][j]);
				fprintf(fp1,"%d ",(int)d2[i][j]);
				fprintf(fp2,"%d ",(int)d3[i][j]);
				fprintf(fp3,"%d ",(int)d4[i][j]);
			}
			else{
				fprintf(fp,"%d\n",(int)d1[i][j]);
				fprintf(fp1,"%d\n",(int)d2[i][j]);
				fprintf(fp2,"%d\n",(int)d3[i][j]);
				fprintf(fp3,"%d\n",(int)d4[i][j]);
			}
		}
	}
	fclose(fp);
	fclose(fp1);
	fclose(fp2);
	fclose(fp3);
}